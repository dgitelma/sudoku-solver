<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>sudoku solver</title>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-alpha/css/bootstrap.min.css" />
  <style>
    .container {
      text-align: center;
      margin-top:20px;
      width: 500px;
    }
    table.table {
      display:inline-block;
      width: 125px;
      margin: 0;
    }
    table.table td {
      border-color: #000;
      padding: 0;
    }
    input {
      height: 100%;
      width: 100%;
      font-size: 20px;
      text-align:center;
      border: none;
    }
  </style>
</head>
<body>
  <div class="container text-center">
    <noscript>
      <div class="alert alert-danger">Sorry, please enable javascript!</div>
    </noscript>

    <form>
      <div id="grid"></div>
      <button class="btn btn-lg btn-danger">Solve Me!</button>
    </form>
  </div>

  <script type="text/html" id="grid-template">
    <table class="table table-bordered">
      <tr>
        <td><input type="number" autofocus maxlength="1" min="1" max="9"/></td>
        <td><input type="number" maxlength="1" min="1" max="9"/></td>
        <td><input type="number" maxlength="1" min="1" max="9"/></td>
      </tr>
      <tr>
        <td><input type="number" maxlength="1" min="1" max="9"/></td>
        <td><input type="number" maxlength="1" min="1" max="9"/></td>
        <td><input type="number" maxlength="1" min="1" max="9"/></td>
      </tr>
      <tr>
        <td><input type="number" maxlength="1" min="1" max="9"/></td>
        <td><input type="number" maxlength="1" min="1" max="9"/></td>
        <td><input type="number" maxlength="1" min="1" max="9"/></td>
      </tr>
    </table>
  </script>

  <script>

    // insert grid template 9x
    var template = "",
      gridTpl = document.getElementById('grid-template').innerHTML;
    for (var i = 0; i < 9; i++) template += gridTpl;
    document.getElementById('grid').innerHTML = template;

    // grab numbers from form inputs
    var button = document.getElementsByTagName('button')[0],
      inputs = document.getElementsByTagName('input');

    // listen for form submit trigger event
    document.getElementsByTagName('form')[0].onsubmit = function(){
      var numbers = Array.prototype.map.call(inputs, function(input){
        if (input.value) {
          input.style.background = '#fff';
          return parseInt(input.value);
        } else {
          input.style.background = '#eee';
          return null;
        }
      });

      // transform numbers to read fully
      // left-to-right over entire grid
      var numbersGrid = [];
      for (var i = 0; i < 3; i++){
        var nums = numbers.slice(i*27, (i*27)+27);
        for (var j = 0; j < 3; j++){
          for (var k = 0; k < 3; k++){
            Array.prototype.push.apply(
              numbersGrid,
              nums.slice((j*3)+(k*9), ((j*3)+3)+(k*9))
            );
          }
        }
      }

      // log to console for debugging
      console.log('Currently solving: \n' + JSON.stringify(numbersGrid));

      // attempt to solve numbers
      var solution = solve(numbersGrid);

      // output result to form
      if (solution instanceof Array &&
        solution.length == 81) {

        // log to console for debugging
        console.log('Solved successfully: \n' + JSON.stringify(solution));

        // update form inputs
        updateGrid(solution);

        // update button label
        button.innerHTML = 'Solved!';
      }

      // output error to form
      else {

        // log to console for debugging
        console.log('Could not solve: ' + JSON.stringify(solution));

        // update button label with error
        button.innerHTML = 'Error! :(';
      }

      return false;
    }

    /**
     * Solve the sudoku puzzle!
     */
    function solve(numbers){
      // numbers = [1,2,3,4,5,6,7,8,9];

      // todo: implement solution

      // return solved array of numbers
      return [
        1,2,3,4,5,6,7,8,9,
        1,2,3,4,5,6,7,8,9,
        1,2,3,4,5,6,7,8,9,
        1,2,3,4,5,6,7,8,9,
        1,2,3,4,5,6,7,8,9,
        1,2,3,4,5,6,7,8,9,
        1,2,3,4,5,6,7,8,9,
        1,2,3,4,5,6,7,8,9,
        1,2,3,4,5,6,7,8,9
      ];
    }

    // init grid with puzzle
    updateGrid([
      0,0,7,0,0,3,7,8,0,
      4,0,3,0,8,0,0,1,7,
      0,8,5,0,0,0,0,3,0,
      0,0,9,7,0,1,5,0,0,
      0,0,4,9,0,2,1,0,0,
      0,0,1,4,0,8,9,0,0,
      0,3,0,0,0,0,7,4,0,
      7,4,0,0,2,0,3,0,1,
      0,9,2,3,0,0,8,0,0
    ]);

    function updateGrid(numbers){
      var idx = 0;
      for (var i = 0; i < 3; i++){
        var nums = numbers.slice(i*27, (i*27)+27);
        for (var j = 0; j < 3; j++){
          [].concat(nums.slice((j*3)+(0), ((j*3)+3)+(0)))
            .concat(nums.slice((j*3)+(9), ((j*3)+3)+(9)))
            .concat(nums.slice((j*3)+(18), ((j*3)+3)+(18)))
            .forEach(function(n){
              inputs[idx].value = n || '';
              idx++;
            });
        }
      }
    };
  </script>
</body>
</html>
